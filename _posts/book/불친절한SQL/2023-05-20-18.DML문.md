---
title: 18. DML 문
date: 2023-05-20 22:43:17 +0900
categories: [BOOK, 불친절한 SQL 프로그래밍]
tags: [sql]  # TAG는 반드시 소문자로 이루어져야함!
---

DML문은 데이터 조작어로 해석할 수 있다. DML 문을 사용하여 테이블에 신규 행을 삽입하거나, 테이블의 기존 행을 갱신, 삭제할 수 있다.

## 18.1 INSERT 문
INSERT 문을 사용하여 테이블에 신규 행을 삽입할 수 있다. 테이블의 개수에 따라 단일 테이블 INSERT문과 다중 테이블 INSERT문으로 구분할 수 있다.

### 18.1.1 단일 테이블 INSERT문
```
-- VALUES 절 : 테이블에 단일행 삽입
INSERT INTO table
VALUES (....)

-- 서브 쿼리 : 서브 쿼리의 결과가 다중 행이면 다중 행이 삽입된다.
INSERT INTO table
subquery
```

### 18.1.2 다중 테이블 INSERT 문
다수의 테이블에 행을 삽입, 조건의 유무에 따라 무조건 INSERT 문, 조건부 INSERT 문으로 구분할 수 있다.

```
— 무조건 INSERT 문
INSERT ALL
    INTO t1(empno, job) VALUES (emopno, job)
    INTO t2(empno, job) VALUES (emopno, job)
SELECT * FROM emp WHERE deptno = 10;

— 무조건 INSERT 문을 사용하면 PIVOT한 데이터를 삽입할 수도 있다.
INSERT ALL
    INTO t1 VALUES (deptno, 'MIN', sal_min)
    INTO t2 VALUES (deptno, 'MAX', sal_max)
    INTO t3 VALUES (deptno, 'SUM', sal_sum)
    INTO t4 VALUES (deptno, 'AVG', sal_avg)
SELECT deptno
        , MIN(sal) AS sal_min, MAX(sal) AS sal_max
        , SUM(sal) AS sal_sum, AVG(sal) AS sal_avg
FROM emp
GROUP BY deptno;

— 조건부 INSERT문 : ALL(모든 테이블에 행 삽입), FIRST(조건을 만족하는 첫 번째 테이블에 행을 삽입)
-- ALL - 조건을 만족하는 모든 테이블에 서브 쿼리의 결과가 삽입된다.
INSERT ALL
WHEN sal >= 2000 THEN INTO t1
WHEN sal >= 3000 THEN INTO t2
ELSE INTO t3
SELECT empno, ename, sal FROM emp WHERE deptno = 10;

-- FIRST - WHEN 절의 기술 순서에 주의해야 한다.
INSERT FIRST
WHEN sal >= 2000 THEN INTO t1
WHEN sal >= 3000 THEN INTO t2
ELSE INTO t3
SELECT empno, ename, sal FROM emp WHERE deptno = 10;
```
