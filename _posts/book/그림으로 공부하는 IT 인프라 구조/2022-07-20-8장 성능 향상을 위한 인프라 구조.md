---
title: 8장 성능 향상을 위한 인프라 구조
date: 2022-07-20 20:54:45 +0900
categories: [BOOK, 그림으로 공부하는 IT 인프라 구조]
tags: [infra]  # TAG는 반드시 소문자로 이루어져야함!
---

## 8.1 응답과 처리량
### 8.1.1 성능 문제의 두 가지 원인
시스템 성능을 가리킬 땐 `응답과 처리량`이라는 지표가 자주 사용된다. 응답은 처리 하나당 소요시간을 의미하며 처리량은 단위 시간당 처리하는 양을 의미한다.

편의점을 예로 들면 계산대가 두 개 있고, 고객이 균등하게 계산대에 줄을 섰을 때, 이때 줄의 끝에 선 후 계산이 끝나기까지 걸리는 시간이 응답시간이고, 계산대에서 한 명당 1분이 걸린다고 하면 계산대가 두 개이기 때문에 1분당 두 명분을 정산할 수 있다. 이것을 처리량이라고 한다.

### 8.1.2 응답 문제
응답 문제가 발생하는 위치는 로그나 실제 장비 시험 등을 통해서 구체적으로 어떤 계층에서 응답 지연이 발생하고 있는지 파악해야 한다.

### 8.1.3 처리량 문제
대량의 데이터를 교환하고 싶은데 영역이 부족한 경우에 처리량 문제가 발생한다. 물리적으로 데이터를 통과시킬 수 없을 때 처리량 관점의 병목 현상이 발생하게 된다.

일반적으로 CPU에서 멀수록 처리량이 낮아진다. 따라서 CPU, 메모리 주변 처리량은 높지만 디스크, 네트워크 통신 대역은 낮아서 병목 현상이 발생하기 쉽다.

응답과 처리량은 밀접한 관계가 있다. 응답이 매우 느린 시스템에서는 다수의 사용자 요청이 시스템 내에 누적되므로 전체 처리량도 낮아진다.

## 8.2 병목 현상이란?
### 8.2.1 처리 속도의 제한 요소가 되는 병목 현상
인프라 아키텍처 용어로서 병목 현상이란 처리량을 제한하고 있는 요인을 가리킨다. 예를 들어 AP 서버에서 CPU 사용률이 높아져서 처리량이 한계에 다다르고 있다고 할 때 처리량이 포화상태 이기 때문에 AP 서버의 응답 시간도 악화된다.
이때 AP 서버가 병목 지점이 된다고 할 수 있다.

### 8.2.2 병목 현상은 어떻게 해결하는가?
성능 분석의 시작은 먼저 병목 현상이 발생하고 있는 위치를 정확히 파악하는 것이다.

__병목 현상 해결방법__
1. 병목 위치를 파악해서 어떻게든 해결하는 것이다(튜닝), 튜닝시에는 병목 위치를 작은 단위로 세분화해서 병목 영역을 더 집중적으로 파헤치는 접근법이 유효하다.
2. 시스템 이용자 수를 제한하는 것(유량 제어)

### 8.2.3 병목 지점은 반드시 존재한다.
예) AP 서버가 병목 지점이 되어 AP 서버를 추가한 경우 웹 서버는 두 대의 AP 서버에 대해 요청을 균등하게 분산한다. AP 서버의 병목 현상이 해결되고 처리량이 개선되었지만 DB 서버에는 두 대의 AP 서버에서 요청이 날라오면서 새로운 병목 지점이 된다.

이처럼 하나의 계층에서 병목 현상이 해결되면 반드시 다른 위치에서 병목 현상이 발생한다. 성능 개선시 반드시 시스템 전체 관점에서 목표를 만드는 것이 중요하다.
