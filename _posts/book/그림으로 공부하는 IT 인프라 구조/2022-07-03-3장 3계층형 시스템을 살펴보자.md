---
title: 3장 3계층형 시스템을 살펴보자
date: 2022-07-03 21:24:39 +0900
categories: [BOOK, 그림으로 공부하는 IT 인프라 구조]
tags: [infra]  # TAG는 반드시 소문자로 이루어져야함!
---

## 3.1 3계층형 시스템의 구성도
<img src="/assets/img/posting_img/book/그림%20IT%20인프라/3계층구성.jpeg" width="700px">

가장 아래에 서버가 배열되어 있고 서버끼리는 스위치를 경유해 연결되어 있다. 각각의 서버 안에는 CPU, 메모리, 디스크 등의 하드웨어 부품이 나열돼 있다. 그리고 그림에서 논리 구성에 해당하는 부분은 OS 영역을 보여주고 있다.

## 3.2 주요 개념 설명
### 3.2.1 프로세스와 스레드
예) 인터넷에서 다운 받은 프로그램을 더블클릭해서 실행시키면 창이 뜬다. 다시 한 번 프로그램 아이콘을 더블클릭 하면 별도의 창이 열린다. 이것이 프로세스나 스레드로 불리는 것이다.

프로세스 및 스레드는 프로그램 실행 파일 자체가 아니라 OS상에서 실행돼서 어느 정도 독립성을 가지고 동작하는 것이다. 프로세스 및 스레드가 활동하려면 메모리 공간이 필요하다. 이것은 커널에 의해 메모리 상에 확보된다.

**메모리 공간을 가지는 것이 '프로세스', 하나의 프로세스가 동작하고 있으면 내부에서는 메모리 공간을 점유하는 스레드 하나가 동작하고 있다. 각 스레드는 메모리 공간을 공유하고 있다.

그림에서 웹 서버에 있는 막대 인간이 프로세스다. 그 주변을 감싸고 있는 하얀 영역이 프로세스의 메모리 공간을 나타낸다. AP 서버에서는 막대인간이 스레드이다. 프로세스는 전용 메모리 공간을 이용해 동작하지만 스레드는 다른 스레드와 메모리 공간을 공유하고 있는 운명 공동체다.

|     |프로세스|스레드|
|-----|------|----|
| 장점  |개별 처리 독립성이 높다.|생성 시 부하가 낮다.|
| 단점  |생성 시 CPU 부하가 높다.|메모리 공간 공유로 의도치 않은 데이터 읽기,쓰기 발생|

### 3.2.2 OS 커널
OS에서 커널이 본질이다. 커널 자체가 OS의 인프라라고 생각하면 된다. OS 처리는 원칙적으로 커널을 통해 이루어 진다.

1. 시스템 콜 인터페이스 : 프로세스/스레드에서 커널로 연결되는 인터페이스이다. 애플리케이션이 OS를 통해 어떤 처리를 할 때 시스템 콜 명령을 이용해 커널에 명령을 내린다.
2. 프로세스 관리 : 언제 어떤 프로세스가 어느 정도의 CPU 코어를 이용할 수 있는지 처리 우선순위를 어떻게 결정할 것이지 등을 관리한다.
3. 메모리 관리 : 물리 메모리 공간의 최대치를 고려한다. 프로세스가 이용하는 독립 메모리 공간을 확보하거나 상호 간의 참조 영역을 지키기 위해 독립성을 관리하는 등의 메모리 관리 역할을 한다.
4. 네트워크 스택
5. 파일 시스템 관리 : 물리 디스크에 제공되는 데이터를 관리하는 기능이다. 문서파일이나 엑셀파일에 해당한다. 주요 관리 기능으로 디렉터리 구조 제공, 액세스 관리, 고속화, 안전성 향상 등이 있다.
6. 장치 드라이버

## 3.3 웹 데이터 흐름
### 3.3.1 클라이언트 PC부터 웹 서버까지
<img src="/assets/img/posting_img/book/그림%20IT%20인프라/데이터의흐름.jpeg" width="700px">

<img src="/assets/img/posting_img/book/그림%20IT%20인프라/PC에서처리흐름.jpeg" width="700px">

PC에서의 처리 흐름은 디스크에서 프로그램을 읽어 프로세스를 시작하고, 메모리 공간을 확보한다. 주소창에 'http://abcd.com'을 입력하면 이름의 해석이 이루어진 후에 웹 브라우저로 접속하게 된다.
이름의 해석이 필요한 이유는 인터넷상의 주소는 IP라는 숫자로 표현돼 있어서 문자열인 URL과 IP를 연결시키지 않으면 통신이 되지 않기 때문이다.

웹 서버에 도착하게 되면 웹 서버는 HTTP 요청에 대해 적절한 파일이나 콘텐츠를 반환한다. 요청에 대한 응답은 HTML 파일이라는 텍스트 데이터나 이미지, 동영상 등의 바이너리 데이터로 구성된다.
그리고 이 데이터는 정적 콘텐츠(실시간으로 변경할 필요가 없는), 동적 콘텐츠(높은 빈도로 변경되는 데이터)로 구분된다.

동적 콘텐츠의 경우 데이터를 서버 내부의 디스크에 저장하면 갱신 빈도가 높기 때문에 디스크 성능이 병목 현상의 원인이 될 수 있다. 그래서 일반적으로 AP 서버가 HTML을 동적으로 생성한다.
