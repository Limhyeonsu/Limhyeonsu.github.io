---
title: 5장 컴퓨터 아키텍처와 운영체제
date: 2022-06-06 22:40:35 +0900
categories: [BOOK, 한 권으로 읽는 컴퓨터 구조와 프로그래밍]
tags: [computer]  # TAG는 반드시 소문자로 이루어져야함!
---

## 기본적인 구조 요소들
가장 흔한 컴퓨터 구조는 폰 노이만 구조와 하버드 구조이다. 두 구조의 유일한 차이는 메모리 배열이다.

<img src="/assets/img/posting_img/book/programingStructure/폰노이만_하버드구조.jpeg" width="700px">

메모리에서 동시에 명령어와 데이터를 가져올 수 없기 때문에 폰 노이만 구조가 약간 더 느리다. 하버드 구조는 동시에 명령어와 데이터를 가져올 수 있어 좀 더 빠르지만 두 번째 메모리를 처리하기 위한 버스가 더 필요하다.

### 1) 프로세서 코어
처음 만들어진 멀티프로세서 시스템은 단일 CPU보다 훨씬 더 좋은 성능을 얻어내기 위한 방법이다. 하지만 성능을 더 높이는게 그렇게 쉽지는 않았다.
CPU를 더 빠르게 만듦으로써 더 나은 성능을 달성할 수 있었지만 기계가 빨라지면 전력을 더 많이 소모하고, 회로 크기는 줄어드는데 기계가 빨라져서 전력을 더 많이 소모하게 되면서 단위 면적당 열 발생은 더 많아졌다.

사람들은 작아진 회로 크기를 활용한 새로운 해결책을 찾았고, CPU를 프로세서 코어라고 부른다. 그리고 이런 코어가 여럿 들어가는 멀티코어 프로세서를 일반적으로 쓴다.

### 2) 마이크로프로세서와 마이크로컴퓨터
물리적인 패키징 구조에 따라 구분하면 메모리와 I/O가 프로세서 코어와 같은 패키지에 들어 있지 않으면 이런 프로세서를 __마이크로프로세서__ 라고 부르고 모든 요소를 한 칩 안에 패키징 하면 __마이크로 컴퓨터__ 라고 부른다.

칩 안에서 메모리가 차지하는 영역이 크기 때문에 일반적으로 마이크로프로세서보다 마이크로 컴퓨터가 덜 강력하다. 따라서 마이크로프로세서는 보통 큰 시스템에 들어가는 부품으로 쓰이고, 마이크로 컴퓨터는 식기세척기 등에서 찾을 수 있는 작은 컴퓨터다.

## 프로시저, 서브루틴, 함수
함수, 프로시저, 서브루틴은 코드를 재사용하는 주요 수단이다. 함수를 작성면 같은 코드를 여러 번 작성하지 않아도 함수를 호출함으로써 해당 코드의 행위를 할 수 있다. 이렇게 동작하기 위해서는 함수를 호출하는 부분에서 함수를 실행하고 다시 원래 자리로 돌아올 방법이 필요하다.
이러한 과정은 상당히 많은 작업이 필요하다. 따라서 대부분 이런 과정을 돕는 명령어를 제공한다. 예)ARM 프로세서에 링크 레지스터를 사용해 분기처리하는 명령어가 있음

## 스택
함수가 자기 자신을 호출하는 경우가 있는데 이를 '재귀'라고 하고, 재귀는 아주 쓸모가 많다. 재귀 함수가 제대로 작동하려면 반환 주소를 여럿 저장할 수 있어야 한다. 그리고 함수에서 호출 지점으로 반환할 때 저장된 주소 중 어떤 주소를 사용할지 결정할 수 있어야 한다.
예를 들면 식당에 쌓아둔 접시 더미를 생각해보자 함수를 호출할 때는 반환 주소를 접시에 넣어 접시 더매 맨 위에 넣는다. 함수 호출에서 돌아올 때는 접시 더미 맨 위의 접시를 보고 반환 주소를 결정한 다음 접시를 제거한다. 이러한 구조를 __스택__ 이라고 한다.

그리고 스택에 물건을 넣을때 더이상 들어갈 공간이 없으면 이를 스택 오버플로우 라고 한다. 또 함수를 호출할 때 해당 지역의 변수값을 그냥 덮어쓰면 안된다. 지역변수도 스택에 같이 저장해야 각각의 함수 호출이 서로 독립적이게 된다.

## 인터럽트
집에서 레시피에 따른 요리를 하는 중이라고 할 때 레시피 대로 요리하는 활동을 순서도(작업이 이뤄지는 순서를 표현한 다이어그램)로 표현할 수 있다. 하지만 중간에 소포 배달원이 온다는 등 예외상황이 발생한다면 순서도 중간에 예외를 처리야하 할 것이다.
순서도 중간중간에 문 앞에 누가 와있는지 확인하는 것을 넣에 되는 방법을 폴링이라고 부른다. 이러한 방법은 문 앞에 누가 왔는지 검사하는 데 많은 시간을 소모하게 된다.

이런 작업을 더 잘 처리하기 위해 실행중인 프로그램을 잠깐 중단 시켜서 주의를 기울여야 하는 외부의 요소에 대응할 수 있게 만들 방법이 필요하다. 그래서 요즘 프로세서 대부분은 인터럽트 시스템이 들어간다.
인터럽트 시스템은 적절한 신호가 들어왔을 때 CPU 실행을 잠깐 중단시킬 수 있는 핀이나 전기 연결을 포함한다.

인터럽트 시스템이 작동되는 방식은 1)CPU가 주의를 기울여야 하는 주변장치는 인터럽트 요청을 생성한다. 2)프로세서는 현재 실행중인 명령어를 끝까지 실행한다. 3)이후 프로세서는 현재 실행중인 프로그램을 잠시 중단하고 인터럽트 핸들러라는 프로그램을 실행한다.
4)인터럽트 핸들러가 작업을 마치면 원래 실행중이던 프로그램이 중단된 위치부터 다시 실행을 계속한다.

인터럽트 시스템을 이용할때 고려해야할 사항이 있다. 1)인터럽트에 대한 응답시간 2)인터럽트를 서비스하고 나중에 다시 원래대로 돌아오기 위해서 현재 상태를 저장할 방법이 필요하다.
인터럽트 시스템은 서비스 후 돌아올 프로그램 위치를 스택에 저장한다.

또 여러가지 종류의 인터럽트 제어가 가능하다. 인터럽트를 중단시킬 수 있는 마스크, 인터럽트 간의 우선순위, 일정 시간이 지나면 인터럽트를 발생시킬 수 있는 내장 타이머 등이 있다.
