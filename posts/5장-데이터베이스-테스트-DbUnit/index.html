<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="5장 데이터베이스 테스트 DbUnit" /><meta property="og:locale" content="en" /><meta name="description" content="5.1 DbUnit의 장점 DB를 사용하는 부분은 프로그래밍 언어 외적인 부분이 상당 부분 포함되기 때문에 TDD를 적용하기가 종종 쉽지 않다. 이럴때 도움을 받을 수 있는 유틸리티로 DbUnit이 있다." /><meta property="og:description" content="5.1 DbUnit의 장점 DB를 사용하는 부분은 프로그래밍 언어 외적인 부분이 상당 부분 포함되기 때문에 TDD를 적용하기가 종종 쉽지 않다. 이럴때 도움을 받을 수 있는 유틸리티로 DbUnit이 있다." /><link rel="canonical" href="https://limhyeonsu.github.io/posts/5%EC%9E%A5-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%ED%85%8C%EC%8A%A4%ED%8A%B8-DbUnit/" /><meta property="og:url" content="https://limhyeonsu.github.io/posts/5%EC%9E%A5-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%ED%85%8C%EC%8A%A4%ED%8A%B8-DbUnit/" /><meta property="og:site_name" content="Hyeonsu Lim" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-16T11:40:45+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="5장 데이터베이스 테스트 DbUnit" /><meta name="twitter:site" content="@imhyeon99494867" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-24T08:26:46+09:00","datePublished":"2022-05-16T11:40:45+09:00","description":"5.1 DbUnit의 장점 DB를 사용하는 부분은 프로그래밍 언어 외적인 부분이 상당 부분 포함되기 때문에 TDD를 적용하기가 종종 쉽지 않다. 이럴때 도움을 받을 수 있는 유틸리티로 DbUnit이 있다.","headline":"5장 데이터베이스 테스트 DbUnit","mainEntityOfPage":{"@type":"WebPage","@id":"https://limhyeonsu.github.io/posts/5%EC%9E%A5-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%ED%85%8C%EC%8A%A4%ED%8A%B8-DbUnit/"},"url":"https://limhyeonsu.github.io/posts/5%EC%9E%A5-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%ED%85%8C%EC%8A%A4%ED%8A%B8-DbUnit/"}</script><title>5장 데이터베이스 테스트 DbUnit | Hyeonsu Lim</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hyeonsu Lim"><meta name="application-name" content="Hyeonsu Lim"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/profile_img.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hyeonsu Lim</a></div><div class="site-subtitle font-italic">Developer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Limhyeonsu" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/imhyeon99494867" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['gustn72096','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>5장 데이터베이스 테스트 DbUnit</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>5장 데이터베이스 테스트 DbUnit</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/imhyeon99494867">Lim Hyeonsu</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652668845" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-16 </em> </span> <span> Updated <em class="timeago" data-ts="1653348406" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-24 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1834 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h3 id="51-dbunit의-장점"><span class="mr-2">5.1 DbUnit의 장점</span><a href="#51-dbunit의-장점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>DB를 사용하는 부분은 프로그래밍 언어 외적인 부분이 상당 부분 포함되기 때문에 TDD를 적용하기가 종종 쉽지 않다. 이럴때 도움을 받을 수 있는 유틸리티로 DbUnit이 있다.</p><ul><li>독립적인 데이터베이스 연결 지원<li>데이터베이스의 특정 시점 상태를 쉽게 내보내거나 읽어들일 수 있다.<li>테이블이나 데이터셋을 서로 쉽게 비교할 수 있다.</ul><p>DbUnit은 독립적으로 사용하기보다는 JUnit 등의 테스트 프레임워크 등과 함께 사용한다. 따라서 테스트 프레임워크라기 보다는 테스트 지원 라이브러리에 더 가깝다.</p><h3 id="52-데이터셋"><span class="mr-2">5.2 데이터셋</span><a href="#52-데이터셋" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>데이터셋은 데이터베이스나 그 안에 존재하는 테이블 혹은 그 일부를 xml이나 csv 파일로 나타낸 모습이다.</p><p>예) SELLER table</p><div class="table-wrapper"><table><thead><tr><th>ID<th>NAME<th>EMAIL<tbody><tr><td>aaaa<td>김가가<td>aaa@naver.com<tr><td>bbbb<td>고나나<td>bbb@hanmail.com<tr><td>cccc<td>황다다<td>ccc@naver.com</table></div><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="nt">&lt;dataset&gt;</span>
  <span class="nt">&lt;seller</span> <span class="na">ID=</span><span class="s">"aaaa"</span> <span class="na">NAME=</span><span class="s">"김가가"</span> <span class="na">EMAIL=</span><span class="s">"aaa@naver.com"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;seller</span> <span class="na">ID=</span><span class="s">"bbbb"</span> <span class="na">NAME=</span><span class="s">"고나나"</span> <span class="na">EMAIL=</span><span class="s">"bbb@hanmail.com"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;seller</span> <span class="na">ID=</span><span class="s">"cccc"</span> <span class="na">NAME=</span><span class="s">"황다다"</span> <span class="na">EMAIL=</span><span class="s">"ccc@naver.com"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/dataset&gt;</span>
</pre></table></code></div></div><p>DbUnit은 이런 데이터셋의 형식을 이용해서 DB의 상태를 저장하거나 변경, 유지한다.</p><h4 id="데이터베이스-연결과-테이블-초기화"><span class="mr-2">데이터베이스 연결과 테이블 초기화</span><a href="#데이터베이스-연결과-테이블-초기화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>현재 가정한 데이터베이스 내의 데이터 내용이 변경된다면 기능 구현에 문제가 없음에도 불구하고 테스트 케이스가 실패할 수 있다. 따라서 현재 가정되어있는 DB안의 데이터 상태가 테스트를 수행하기 전에 가정했던 모습으로 한결같이 유지 됐으면 좋겠다. 그래서 테스트 관련 테이블 초기화 -&gt; 테스트 케이스 수행 이라는 전략을 세웠다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DatabaseRepositoryTest</span> <span class="o">{</span>
  <span class="c1">//.....</span>

  <span class="c1">//1.DbUnit을 사용하기 위해서는 DbUnit에서 제공하는 DBTestCase를 상속하도록 작성한다.</span>
  <span class="c1">//상속하지 않고 DbUnit에서 제공하는 기능을 이용하려면 IDatabaseTester라는 인터페이스를 사용하면 된다.</span>
  <span class="kd">private</span> <span class="nc">IDatabaseTester</span> <span class="n">databaseTester</span><span class="o">;</span>

  <span class="nd">@Before</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="c1">//2. IDatabaseTester 구현체로 JDBC 연결방식을 이용한다.</span>
    <span class="n">databaseTester</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JdbcDatabaseTester</span><span class="o">(</span><span class="n">driver</span><span class="o">,</span> <span class="n">protocol</span><span class="o">+</span><span class="n">dbName</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="c1">//3. 데이터셋을 지정한다.</span>
      <span class="nc">IDataSet</span> <span class="n">dataSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FlaxXmlDataSetBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"seller.xml"</span><span class="o">));</span>
      <span class="c1">//4. DB커넥션과 데이터셋을 이용해 DB에 특정 작업을 수행한다.</span>
      <span class="nc">DatabaseOperation</span><span class="o">.</span><span class="na">CLEAN_INSERT</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">databaseTester</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(),</span> <span class="n">dataSet</span><span class="o">);</span>
    <span class="o">}</span><span class="k">finally</span> <span class="o">{</span>
      <span class="n">databaseTester</span><span class="o">.</span><span class="na">getConnection</span><span class="o">().</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>위 setUp() 메소드는 테스트 메소드가 수행되기 전에 항상 seller.xml에 지정된 상태로 테이블을 초기화한다.</p><h4 id="데이터셋-비교"><span class="mr-2">데이터셋 비교</span><a href="#데이터셋-비교" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">//1. 현재 데이터베이스의 상태를 데이터 셋으로 추출한다.</span>
<span class="nc">IDataSet</span> <span class="n">currentDBdataSet</span> <span class="o">=</span> <span class="n">databaseTester</span><span class="o">.</span><span class="na">getConnection</span><span class="o">().</span><span class="na">createDataSet</span><span class="o">();</span>

<span class="c1">//2. 데이터셋에서 특정 테이블을 가져온다.</span>
<span class="nc">ITable</span> <span class="n">actualTable</span> <span class="o">=</span> <span class="n">currentDBdataSet</span><span class="o">.</span><span class="na">getTable</span><span class="o">(</span><span class="s">"seller"</span><span class="o">);</span>

<span class="c1">//3.미리 만들어놓은 예상 데이터셋을 읽어들인다.</span>
<span class="nc">IDataSet</span> <span class="n">expectedDataSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FlaxXmlDataSetBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"expected_seller.xml"</span><span class="o">));</span>

<span class="c1">//4. 예상 데이터셋 중에서 비교에 사용할 테이블을 읽어들인다.</span>
<span class="nc">ITable</span> <span class="n">expectedTable</span> <span class="o">=</span> <span class="n">expectedDataSet</span><span class="o">.</span><span class="na">getTable</span><span class="o">(</span><span class="s">"seller"</span><span class="o">);</span>

<span class="c1">//5. DbUnit에서 제공하는 Assertion 클래스의 메소드를 이용해 결과를 비교한다.</span>
<span class="nc">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="n">expectedTable</span><span class="o">,</span> <span class="n">actualTable</span><span class="o">);</span>
</pre></table></code></div></div><h3 id="53-dbunit-데이터셋의-종류"><span class="mr-2">5.3 DbUnit 데이터셋의 종류</span><a href="#53-dbunit-데이터셋의-종류" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>DbUnit은 DB 데이터의 구조를 나타내기 위해 데이터셋이라는 개념을 사용한다. 데이터셋은 하나의 타입을 나타냄과 동시에 테이블들의 집합체를 표현하는 IDataSet 인터페이스의 구현체를 의미하기도 한다.</p><h4 id="flatxmldataset"><span class="mr-2">FlatXmlDataSet</span><a href="#flatxmldataset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>테이블 이름을 XML TAG 구성요소로 적는다.<li>컬럼 이름은 속성으로 적는다.<li>null 값을 넣을 컬럼은 표현하지 않는다. 자동으로 null 값이 들어간다.<li>XML, DTD를 지정하지 않아도 된다.<li>데이터셋 중 가장 흔하게 사용된다.</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>&lt;dataset&gt;
  &lt;EMPLOYEE NO="101" NAME="안병현" EMAIL="megan@hssm.kr"&gt;&lt;/EMPLOYEE&gt;
&lt;/dataset&gt;
</pre></table></code></div></div><h4 id="xmldataset"><span class="mr-2">XmlDataSet</span><a href="#xmldataset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>다소 장황한 버전<li>DTD 반드시 포함<li>잘 사용하지 않음</ul><h4 id="streamingdataset"><span class="mr-2">StreamingDataSet</span><a href="#streamingdataset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>데이터베이스의 커서 개념처럼 단방향으로 동작, 현재 레코드만 메모리에 존재<li>UPDATE, INSERT, REFRESH 같은 동작을 하는 XML 데이터셋을 읽어들일 때 매우 효율적으로 동작</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>IDataSetProducer producer = new FlatSmlProducer(new InputSource("dataset.xml"));
IDataSet dataSet = new StreamingDataSet(producer);
</pre></table></code></div></div><h4 id="databasedataset"><span class="mr-2">DatabaseDataSet</span><a href="#databasedataset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>데이터베이스 인스턴스에 대한 접근을 제공한다.<li>직접 new로 생성하지 않고 팩토리 메소드로 만들어낸다.</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IDataSet currentDBdataSet = IDatabaseConnection.createDataSet();
</pre></table></code></div></div><h4 id="querydataset"><span class="mr-2">QueryDataSet</span><a href="#querydataset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>쿼리문으로 데이터셋을 만들어낸다.</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>QueryDataSet dataSet = new QueryDAtaSet(connection);
dataSet.addTable("NEW_EMPLOYEE", "SELECT * FROM EMPLOYEE WHERE EMPNO &gt; 600");
dataSet.addTAble("DEPARTMENT");
</pre></table></code></div></div><h4 id="xlsdataset"><span class="mr-2">XlsDataSet</span><a href="#xlsdataset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>MS 엑셀 문서를 데이터셋으로 인식한다.<li>엑셀 문서 내의 각 시트를 테이블로 인식한다.<li>시트의 첫 번째 줄을 컬럼으로 인식한다.<li>나머지 줄은 데이터 값으로 인식한다.</ul><h4 id="replacementdataset"><span class="mr-2">ReplacementDataSet</span><a href="#replacementdataset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ul><li>데이터셋에서 특정한 문자열을 치환하기 위해 사용한다.<li>보통은 null 값을 다르게 표현하고 런타임시에 치환하는 데 많이 사용한다.</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>&lt;dataset&gt;
  &lt;EMPLOYEE NO="101" NAME="안병현" EMAIL="megane@hssm.kr"&gt;&lt;/EMPLOYEE&gt;
  &lt;EMPLOYEE NO="102" NAME="김상옥" EMAIL="[null]"&gt;&lt;/EMPLOYEE&gt;
&lt;/dataset&gt;
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>ReplacementDataSet dataSet = new ReplacementDataSet(new FlaxXmlDataSet(...));
dataSet.addReplacementPbject("[NULL]", null);
</pre></table></code></div></div><h3 id="54-dbunit의-db-지원-기능"><span class="mr-2">5.4 DbUnit의 DB 지원 기능</span><a href="#54-dbunit의-db-지원-기능" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>DbUnit에서는 데이터셋을 이용한 DB관리 작업을 DataBaseOperation이라는 개념으로 만들어 놓았다. <code class="language-plaintext highlighter-rouge">DatabaseOperation.오퍼레이션이름.execute(DB커넥션, 데이터셋)</code></p><p>[오퍼레이션의 종류]</p><p><img data-src="/assets/img/posting_img/book/TDD/DbUnit오퍼레이션종류1.jpeg" width="650px" data-proofer-ignore> <img data-src="/assets/img/posting_img/book/TDD/DbUnit오퍼레이션종류2.jpeg" width="650px" data-proofer-ignore></p><h3 id="55-dbunit과-ant"><span class="mr-2">5.5 DbUnit과 Ant</span><a href="#55-dbunit과-ant" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Ant를 사용하는 경우 개발툴이나 IDE에 의존하지 않고, 시스템 레벨에서 배치 작업등을 이용해 좀 더 높은 수준의 자동화를 이룰 수 있다.</p><p>DbUnit에서 Ant를 이용하기 위해서는 dbunit.jar 파일을 추가한다. 그리고 Ant 빌드파일 내에 태스크를 정의한다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;taskdef name="dbunit" classname="org.dbunit.ant.DbUnitTask"/&gt;
</pre></table></code></div></div><p><strong>Ant 적용전</strong></p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nd">@Before</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  <span class="n">databaseTester</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JdbcDatabaseTester</span><span class="o">(</span><span class="n">driver</span><span class="o">,</span> <span class="n">protocol</span><span class="o">+</span><span class="n">dbName</span><span class="o">);</span>
  <span class="nc">IDataSet</span> <span class="n">dataSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FlaxXmlDataSetBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"seller.xml"</span><span class="o">));</span>
  <span class="nc">DatabaseOperation</span><span class="o">.</span><span class="na">CLEAN_INSERT</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">databaseTester</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(),</span> <span class="n">dataSet</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><strong>Ant 적용후</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>&lt;target name="sellerdb-init"&gt;
  &lt;dbunit driver="org.apache.derby.jdbc.EmbeddedDriver"
          url="jdbc:derby:shopdb"
          userid=""
          password=""
          &gt;
          &lt;opration type="CLEAN_INSERT" src="seller.xml"/&gt;
  &lt;/dbunit&gt;
&lt;/target&gt;
</pre></table></code></div></div><p>이처럼 무언가 일괄적으로 DbUnit을 이용해 DB를 조작할 때 Ant를 이용하면 유리하다.</p><h2 id="56-정리"><span class="mr-2">5.6 정리</span><a href="#56-정리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>데이터셋을 만드는 일은 비용과 노력이 많이 드는 작업이며, DbUnit을 반드시 써야할지는 고민해볼 필요가 있다.</p><ul><li>개발자마다 데이터베이스 인스턴스나 스키마를 하나씩 사용하자<li>나중에 정리할 필요가 없게 setUp 처리를 잘하자<li>데이터셋의 크기는 작고, 여러개를 만드는네 꼭 필요한 테스트 데이터 위주로 만들자<li>데이터셋을 너무 많이 만들지 말라<li>클래스 기반으로 만들고 다른 테스트 클래스와 공유해서 사용하지 말자</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/book/'>BOOK</a>, <a href='/categories/tdd-%EC%8B%A4%EC%B2%9C%EB%B2%95%EA%B3%BC-%EB%8F%84%EA%B5%AC/'>TDD 실천법과 도구</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tdd/" class="post-tag no-text-decoration" >tdd</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=5%EC%9E%A5+%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4+%ED%85%8C%EC%8A%A4%ED%8A%B8+DbUnit+-+Hyeonsu+Lim&url=https%3A%2F%2Flimhyeonsu.github.io%2Fposts%2F5%25EC%259E%25A5-%25EB%258D%25B0%25EC%259D%25B4%25ED%2584%25B0%25EB%25B2%25A0%25EC%259D%25B4%25EC%258A%25A4-%25ED%2585%258C%25EC%258A%25A4%25ED%258A%25B8-DbUnit%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=5%EC%9E%A5+%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4+%ED%85%8C%EC%8A%A4%ED%8A%B8+DbUnit+-+Hyeonsu+Lim&u=https%3A%2F%2Flimhyeonsu.github.io%2Fposts%2F5%25EC%259E%25A5-%25EB%258D%25B0%25EC%259D%25B4%25ED%2584%25B0%25EB%25B2%25A0%25EC%259D%25B4%25EC%258A%25A4-%25ED%2585%258C%25EC%258A%25A4%25ED%258A%25B8-DbUnit%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Flimhyeonsu.github.io%2Fposts%2F5%25EC%259E%25A5-%25EB%258D%25B0%25EC%259D%25B4%25ED%2584%25B0%25EB%25B2%25A0%25EC%259D%25B4%25EC%258A%25A4-%25ED%2585%258C%25EC%258A%25A4%25ED%258A%25B8-DbUnit%2F&text=5%EC%9E%A5+%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4+%ED%85%8C%EC%8A%A4%ED%8A%B8+DbUnit+-+Hyeonsu+Lim" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="Limhyeonsu/Limhyeonsu.github.io" issue-term="pathname" theme="github-dark" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/15.Top-N%EC%BF%BC%EB%A6%AC/">15. Top-N 쿼리</a><li><a href="/posts/09.%EB%A9%B4%EC%A0%91%EB%AC%B8%EC%A0%9C/">09. 면접문제</a><li><a href="/posts/14.%EB%B6%84%EC%84%9D%ED%95%A8%EC%88%98/">14. 분석함수</a><li><a href="/posts/07.%EA%B8%B0%EC%88%A0%EC%A0%81-%EB%AC%B8%EC%A0%9C/">07. 기술적 문제</a><li><a href="/posts/06.bigO/">06. big-O</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/software-engineering/">software_engineering</a> <a class="post-tag" href="/tags/jpa/">jpa</a> <a class="post-tag" href="/tags/computer/">computer</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/infra/">infra</a> <a class="post-tag" href="/tags/tdd/">tdd</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/bufferedreader/">bufferedreader</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/1%EC%9E%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EA%B0%9C%EB%B0%9C/"><div class="card-body"> <em class="timeago small" data-ts="1651581016" > 2022-05-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>1장 테스트 주도 개발</h3><div class="text-muted small"><p> 1.1 흔하디 흔한 소프트웨어 개발 방식 전통적인 소프트웨어 개발 방식에서는 문제가 발생하고, 문제를 해결하고, 검증을 위한 테스트를 진행시 대표적으로 ‘콘솔’ 화면에 값을 찍어보는 방식을 사용했다. 대개 이런 경우 작성된 코드의 문제 유무 판단을 개발자 자신의 두뇌에 상당 부분 의존하게 된다. 이러한 전통적인 개발 및 테스트에서는 다음의 문제들을 ...</p></div></div></a></div><div class="card"> <a href="/posts/2%EC%9E%A5-JUnit%EA%B3%BC-Hamcrest/"><div class="card-body"> <em class="timeago small" data-ts="1651818452" > 2022-05-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>2장 JUnit과 Hamcrest</h3><div class="text-muted small"><p> 2.1 JUnit JUnit은 현재 전 세계적으로 가장 널리 사용되는 Java 단위 테스트 프레임워크이다. 기본적으로 다음과 같은 기능을 제공한다. 테스트 결과가 예상과 같은지를 판별해주는 단정문 여러 테스트에서 공용으로 사용할 수 있는 테스트 픽스처 테스트 작업을 수행할 수 있게 해주는 테스트 러너 꼭 알아두어야할 개념으로 테스트 픽...</p></div></div></a></div><div class="card"> <a href="/posts/3%EC%9E%A5-TDD-%EC%A2%80-%EB%8D%94-%EC%9E%98%ED%95%98%EA%B8%B0/"><div class="card-body"> <em class="timeago small" data-ts="1652061152" > 2022-05-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>3장 TDD 좀 더 잘하기</h3><div class="text-muted small"><p> 3.1 테스트 케이스 클래스의 위치 단위 테스트 케이스를 소스 구조 안에서 어디에 놓을 것인지 결정해야 한다. 1)테스트 대상 소스와 테스트 클래스를 같은 곳에 테스트 클래스와 같은 패키지 내에 놓는 가장 기본적인 형태이다. 간단한 테스트 생성시 외에 사용하지 않는다. 2)테스트 클래스는 하위 패키지로 예) src/bank - 제품코드 클래스,...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/4%EC%9E%A5-%ED%95%9C%EA%B3%84-%EB%8F%8C%ED%8C%8C%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%85%B8%EB%A0%A5,-Mock%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-TDD/" class="btn btn-outline-primary" prompt="Older"><p>4장 한계 돌파를 위한 노력, Mock을 이용한 TDD</p></a> <a href="/posts/6%EC%9E%A5-%EB%8B%A8%EC%9C%84%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A7%80%EC%9B%90-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-Unitils/" class="btn btn-outline-primary" prompt="Newer"><p>6장 단위테스트 지원 라이브러리:Unitils</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/imhyeon99494867">Lim Hyeonsu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/software-engineering/">software_engineering</a> <a class="post-tag" href="/tags/jpa/">jpa</a> <a class="post-tag" href="/tags/computer/">computer</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/infra/">infra</a> <a class="post-tag" href="/tags/tdd/">tdd</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/bufferedreader/">bufferedreader</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
